<html><head>
<title>Input focus after 1s after visibility hidden state</title>

<style>
</style>
</head>
<body>
<input id="input">
<pre id="result"></pre>
<script>
    function doe() {
if ('visibilityState' in document) {
        document.getElementById('result').innerHTML += 'document.visibilityState:' + document.visibilityState + '<br>';
        document.getElementById('result').innerHTML += 'document.hidden:' + document.hidden + '<br>';

if (document.hidden) {
document.getElementById('input').focus();
}
}
else
        document.getElementById('result').innerHTML += 'document.mozVisibilityState:' + document.mozVisibilityState + '<br>';
        document.getElementById('result').innerHTML += 'document.mozHidden:' + document.mozHidden + '<br>';

if (document.mozHidden) {
document.getElementById('input').focus();
}
    }  
doe();
  document.addEventListener('visibilitychange', doe, true);
document.addEventListener('mozvisibilitychange', doe, true);
</script>
</body>
</html>